<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  ~ This file is part of NxFIFTEEN Fitness Core.
  ~
  ~ Copyright (c) 2017. Stuart McCulloch Anderson
  ~
  ~ For the full copyright and license information, please view the LICENSE
  ~ file that was distributed with this source code.
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->

<script>
    //    var requireJS = [];
    //
    //    loadJS(requireJS, "");
    //    loadCSS("");
    setUpBreadcrumb(['Settings'], 'Account');
</script>

<div class="animated fadeIn">
    <div class="row">
        <div class="col-8">
            <div class="card">
                <div class="card-header">Profile</div>
                <div class="card-block">
                    <div class="row" id="syncTotalProgress"></div>
                </div>
            </div>
        </div>

        <div class="col-4">
            <div class="card">
                <div class="card-header">Actions</div>
                <div class="card-block">
                    <span id="actionsText"></span>
                    <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#dangerModal"><i class="fa fa-bomb"></i>&nbsp; Delete Account!</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="dangerModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-danger" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Account Deletion</h4>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>This action will delete your account from NxCore. This is unrevocable, so be sure before you hit the button.</p>
            </div>
            <div class="modal-footer">
                <form class="form-signin" id="accDeletion">
                    <input type="hidden" name="formId" value="accDeletion">
                    <button type="button" class="btn btn-success" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-danger">Yes, Delete My Account</button>
                </form>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<script type="application/javascript">
    // this is the id of the form
    $("#accDeletion").submit(function (e) {

        $('#dangerModal').modal('hide');

        var url = "../ajax.php"; // the script where you handle the form input.
        var data = $("#accDeletion").serialize();

        var html = '';
        html += '                <p>I\'m currently deleting your account.</p>';
        html += '                <p>This process can take 20/30 seconds, and you dont have to stick around for it. Once complete this page will refresh and you will be logged out.</p>';
        $('#actionsText').html(html).show();

        $.ajax({
            type: "POST",
            url: url,
            data: data
        }).done(function (response) {
            window.location.href = "views/pages/logout";
        }).fail(function (response) {
            $('#actionsText').html(response.responseText);
        });

        e.preventDefault(); // avoid to execute the actual submit of the form.
    });
</script>